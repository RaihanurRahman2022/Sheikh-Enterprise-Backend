// title
title Retail Business Management System

// define tables
company [icon: building, color: lightblue] {
  company_id string pk
  name string
  address string
  phone string
  email string
  slogan string
  remarks string
}

shop [icon: store, color: lightgreen] {
  shop_id string pk
  company_id string fk
  name string
  address string
  phone string
  email string
  manager_name string
  manager_phone string
  remarks string
}

product [icon: box, color: orange] {
  product_id string pk
  code string
  name string
  style string
  master_category string
  sub_category string
  color string
  size string
  purchase_price float
  sales_price float
  sales_type string
  update_datetime datetime
  updated_by string fk
  remarks string
}

inventory [icon: clipboard, color: purple] {
  inventory_id string pk
  product_id string fk
  shop_id string fk
  quantity int
}

supplier [icon: truck, color: red] {
  supplier_id string pk
  name string
  address string
  phone string
  email string
  remarks string
}

customer [icon: user, color: yellow] {
  customer_id string pk
  name string
  address string
  phone string
  email string
  remarks string
}

user [icon: user-check, color: blue] {
  user_id string pk
  username string
  password string
  name string
  shop_id string fk
  role string
}

purchase_invoice [icon: file-text, color: lightcoral] {
  purchase_invoice_id string pk
  supplier_id string fk
  purchase_datetime datetime
  total float
  payment_type string
  entry_by string fk
  remarks string
}

purchase_detail [icon: list, color: lightcoral] {
  detail_id string pk
  purchase_invoice_id string fk
  product_id string fk
  quantity int
  purchase_price float
}

sales_invoice [icon: file-text, color: lightseagreen] {
  invoice_id string pk
  shop_id string fk
  customer_id string fk
  sales_by string fk
  sale_datetime datetime
  total float
  discount float
  discount_by string fk
  remarks string
}

sales_detail [icon: list, color: lightseagreen] {
  detail_id string pk
  invoice_id string fk
  product_id string fk
  quantity int
  sales_price float
  subtotal float
}

stock_transfer [icon: arrows, color: lightsteelblue] {
  transfer_id string pk
  product_id string fk
  to_shop_id string fk
  from_shop_id string fk
  quantity int
  transfer_datetime datetime
  transferred_by string fk
}

payment [icon: credit-card, color: lightgoldenrodyellow] {
  payment_id string pk
  type string
  supplier_id string fk
  customer_id string fk
  amount float
  payment_datetime datetime
  remarks string
}

// define relationships
shop.company_id > company.company_id
inventory.product_id > product.product_id
inventory.shop_id > shop.shop_id
purchase_invoice.supplier_id > supplier.supplier_id
purchase_invoice.entry_by > user.user_id
purchase_detail.purchase_invoice_id > purchase_invoice.purchase_invoice_id
purchase_detail.product_id > product.product_id
sales_invoice.shop_id > shop.shop_id
sales_invoice.customer_id > customer.customer_id
sales_invoice.sales_by > user.user_id
sales_invoice.discount_by > user.user_id
sales_detail.invoice_id > sales_invoice.invoice_id
sales_detail.product_id > product.product_id
stock_transfer.product_id > product.product_id
stock_transfer.to_shop_id > shop.shop_id
stock_transfer.from_shop_id > shop.shop_id 
stock_transfer.transferred_by > user.user_id
payment.supplier_id > supplier.supplier_id
payment.customer_id > customer.customer_id
product.updated_by > user.user_id
user.shop_id  > shop.shop_id
